# Pocket-home: Bismuth Edition Task List

1/21:
    -Fix Wifi deadlocks when checking saved connections within NM callbacks.
        -Is this a problem with SharedResource::Handler notifications that can
         be fixed?
        -Even if it is, reduce LibNM interaction by tracking saved connection
         state in Wifi::AccessPoint
    -Fix over-enthusiastic Wifi::SettingsPage sorting
    -Fix scrolling list animations; old list items aren't animated when
     scrolling out
    -Continue building Wifi test classes
    -Update this document

### Documentation
    -Priority:  Change list is out of date, check commit messages and update it.

    1. Create a list of all code files, and use it to systematically check
       existing documentation.
    2. Create a Markdown page outlining the entire project structure.
    3. Create pages documenting each code group.
    4. Document all config files and options.
    5. Generate UML diagrams.
        
## Misc. bug fixes and improvements
    -Define missing ColourId values for custom component classes.
    -Figure out why the "file" label in the file selection window gets cut off.

#### Known documentation issues for individual classes
    -AppMenu helper classes are missing full documentation.
    -PokeLookAndFeel.h is missing some @param tags.

### Version Management

# Task list for release 0.10

## AppMenu Improvements
    1. Write unit tests
    2. Add desktop actions to context menus
    3. Show error alerts for desktop entry exceptions.

## Wifi Improvements
    1. JSONWifiInterface really isn't helpful, and accomodating it creates
       unacceptable design complexity.  Get rid of it.
        -Eventually it should be replaced with a fake Wifi control library
         that copies LibNM's interface.
    2. The level of interaction between GLibSignalThread and NetworkInterface
       creates way too many opportunities for deadlocks.  Merge GLibSignalThread
       and NetworkInterface into a single SharedResource, and ensure GLib::Objects
       do not use that thread if they're not part of LibNM.
    3. Using GLib SignalHandlers outside of the Wifi thread is not safe with
       this version of LibNM.  Remove internal NMPPAccessPoint objects from
       WifiAccessPoints and make WifiAccessPoint get that data through the
       WifiStateManager.
    4. Update the HomePage wifi icon to better use new wifi features.
       1. Add a Listener interface to WifiAccessPoint objects.
       2. Have the wifi icon extend WifiAccessPoint::Listener.
    5. Add a "Forget saved connection" button to saved wifi access points.
    6. Continue implementing test classes.

## FreeDesktop Standards/ DesktopEntry Improvements
    1. Fix problems with re-creating hidden entries.
    2. Add support for launching applications through d-bus when desktop entries
       request it.
    3. Research the FreeDesktop standard for tracking launched applications, and
       integrate it into AppLauncher. 
    4. Move all functionality in AssetFiles to XDGDirectories
    5. Place config files and lock files in directories selected with
       XDGDirectories.
    6. Write DesktopEntry and DesktopEntryLoader test classes.

## Configuration Improvements
    1. Add config. option for enabling/disabling that PocketCHIP audio hack. 
    2. Recreate config test class.

## Project Structure Improvements
    1. Restructure project into Namespace packages
    2. Don't recursively include all source directories in all files
    3. Sort makefile *.o list by package

## Settings Page Improvements

### Quick Settings Page

    1. Restore the IP address label.

### DateTime Page

    1. Remove this page until admin/authentication handling is implemented.
    2. Consider restoring with built-in date/time setting components.

### Home Settings Page

    1. Move the clock settings to this page from the DateTime page.
    2. Add options to show/hide the battery icon and wifi icon.
    3. Change the page background settings to control background image only.

### Input Page

    1. Remove FN key fix - it doesn't seem to actually fix anything.
 
### Password Pages

    1. The set password page isn`t hiding the current password field.
    2. Fix issue where the program hangs on authentication in PocketCHIP.

### Colour Page

    1. Add the color page to the settings list page.
    2. Add missing ColourID values to custom component classes.
    3. Adjust color picker and color list components.
    4. Save and apply changes through ColourConfigFile.

# Unscheduled future improvements

## Admin and Authentication
    1. Write a setuid program to handle root actions.
        -Updating the application password.
        -Saving calibration data. 
    2. Create custom PolKit policies for interacting with the setuid program.
    3. Look into implementing a custom PolKit authentication agent.

## Keybinding Controls
    -Decide on implementation approach, add to input settings page.

## Component editing
    -Consider a custom page for this.
    -Support for editing configurableComponents
    -Directly set font size.

## Icons
    -Add an icon selection Component that uses IconThread's index of icon files
        1. Create a method that loads all available icon names from icon
           directories and cache files.
        2. Create a list component that displays all available icons.
        3. Create a popup editor component, containing that list component and
           a field for entering misc. icon paths.
    -Add .xpm image support
    -Fix rendering issues with some .svg icons

## Bluetooth
    1. Study [bluez bluetooth code.]: https://git.kernel.org/pub/scm/bluetooth/bluez.git/tree/client/main.c
    2. Implement all basic bluetooth functionality.
        1. Detecting if bluetooth is enabled.
        2. Enabling and disabling the bluetooth radio.
        3. Listing all connected, paired, visible, and saved bluetooth devices.
        4. Pairing with new bluetooth devices.
        5. Setting the bluetooth radio as discoverable.
    3. Implement BluetoothSettingComponent and BluetoothSettingPage
    4. Research bluetooth file transfer to see if pocket-home should handle it.

## Multi-System Support 
    -Test pocket-home on all of my linux devices.
    -Define all system commands in a single .json file in assets
        (*not* editable without admin permissions!) 
    -List all pocket-home functionality that is PocketCHIP specific
    -Create a class that scans for various system features
        -Wifi
        -Bluetooth
        -Controllable backlight
        -Audio support
        -Flashing support
        -Input options
    -Create a class that can automatically disable a component if one or more
     of these features is not available

## Control/Input improvements
    -Create an organized control system for managing key presses and 
     transferring keyboard focus.
    -Ensure that everything controllable by touch/mouse input can also be
     controlled by keyboard input, and vice versa.
    -Look into alternate text entry methods for systems without physical
     keyboards.
     
## Build improvements
   -Switch to using CMake  
